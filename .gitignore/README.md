# dna-protein-complex

 Python visualization of PDB-format and searching for some structure using Voronoi diagrams and Delaunay triangulations.

## Installation


1. Clone repository
```sh
git clone git@git.masoft.ru:teatracer7/dna-protein-complex.git
```

2. Download requirements and run script
```sh
cd dna-protein-complex
pip install -r requirements.txt
python run.py
```

## Исходные данные

Исходными данными являются 30 файлов в формате "Protein Data Bank" ("pdb"), в которых находятся данные о
расположении белков и ДНК во время из взаимодействия. В 24 файлах присутствуют молекулы воды.
В одном файле может быть несколько фрагментов белков. Некоторые файлы имеют два идентичных
фрагмента ДНК. Известны названия и координаты атомов.

## Разметка данных

В формате "pdb" не указано явно, относится атом к белку или к ДНК. Это можно сделать, основываясь на
названиях молекул, а также через визуализацию в программе "PyMol". В формате "pdb" атомы сгруппированы в
цепочки. ДНК состоит из двух цепочек, совпадающих с двумя спиралями. На каждый белок приходится по одной цепочке.
Для разметки атомов используется файл "pdb.json" в котором каждому интерфейсу белок-ДНК сопоставляются названия цепочек
ДНК, цепочки белка и название "pdb"-файла.

## Импорт данных

Импорт в разрабатываемую программу на языке программирования "Python3.6". Импорт осуществляет библиотека "Biopython",
которая преобразует "pdb"-файл в объект языка. После этого используя файл разметки, выделяются атомы воды, атомы
белка и атомы ДНК, соответствующие одному взаимодействию белок-ДНК.

## Выделение связей

Для выделения связей используется алгоритм построения триангуляции Делоне. Область поиска связей сузилась до связей
с соседями по триангуляции. Все возможные связи разделяются на четыре типа: ковалентные в белке,
ковалентные в ДНК, прямые связи белок-ДНК и связи через воду. Максимальная длина связи между атомами
принимается равной 4Å (четыре ангстрема). Максимальная длина ковалентных связей принимается равной 2Å.
Связи через воду состоят из двух связей с водой, каждая до 4Å.

## Атомы интерфейса

После определения связей выделяются атомы, участвующие в связях типа белок-ДНК. Получается два множества интерфейсных
атомов: на белке и на ДНК. Затем для визуализации интерфейса нужно построить связи между интерфейсными атомами внутри
своих групп. Для этого с помощью триангуляции Делоне для каждого интерфейсного атома ищутся близжайшие
интерфейсные атомы из той же группы. Путь, связывающий эти атомы, является кратчайшим путем в графе ковалентных связей.
В итоге получается каркас интерфейса.

## Экспорт интерфейса

Полный интерфейс состоит из каркаса со стороны белка, каркаса со стороны ДНК,
связей белок-ДНК и связей через воду, если они есть. Из этих данных составляется "pdb"-файл с
участвующими в интерфейсе атомами и указываются связи.

## Визуализация интерфейса

Файл с интерфейсом открывается в программе "PyMol".
